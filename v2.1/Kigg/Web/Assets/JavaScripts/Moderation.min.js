var Moderation={_markCommentAsOffendedUrl:"",_spamCommentUrl:"",_deleteStoryUrl:"",_spamStoryUrl:"",_approveStoryUrl:"",_getStoryUrl:"",_centerMeTimer:null,set_markCommentAsOffendedUrl:function(A){Moderation._markCommentAsOffendedUrl=A},set_spamCommentUrl:function(A){Moderation._spamCommentUrl=A},set_deleteStoryUrl:function(A){Moderation._deleteStoryUrl=A},set_spamStoryUrl:function(A){Moderation._spamStoryUrl=A},set_approveStoryUrl:function(A){Moderation._approveStoryUrl=A},set_getStoryUrl:function(A){Moderation._getStoryUrl=A},init:function(){$("#storyEditorBox").keydown(function(A){if(A.keyCode===27){Moderation._hide()}});$("#storyEditorClose").click(function(){Moderation._hide()});$("#frmStoryUpdate").validate({rules:{name:"required",createdAt:"required",description:{required:true,rangelength:[8,2048]},category:"required"},messages:{name:"Nazwa nie może być pusta.",createdAt:"Data utworzenia nie może być pusta.",title:{required:"Tytuł nie może być pusty.",maxlength:"Tytuł nie może być dłuższy niż 256 znaków."},description:{required:"Opis nie może być pusty.",rangelength:"Opis musi być pomiędzy 8 a 2048 znaków."},category:"Kategoria musi być wybrana."},submitHandler:function(B){var A={dataType:"json",beforeSubmit:function(C,E,D){$("#updateStoryMessage").text("").css("color","").hide();$U.disableInputs("#frmStoryUpdate",true);$U.showProgress("Aktualizowanie wpisu...","#btnUpdateStory")},success:function(C){$U.disableInputs("#frmStoryUpdate",false);$U.hideProgress();if(C.isSuccessful){Moderation._hide()}else{$("#updateStoryMessage").text(C.errorMessage).css({color:"#ff0000",display:"block"})}}};$(B).ajaxSubmit(A)},errorPlacement:function(A,B){B.parents("p:first").find("span.error").text(A.text())},highlight:function(B,A){$(B).parents("p:first").find("span.error").show()},unhighlight:function(B,A){$(B).parents("p:first").find("span.error").hide()}})},dispose:function(){},editStory:function(B){var A="id="+encodeURIComponent(B);$U.disableInputs("#frmStoryUpdate",true);$.ajax({url:Moderation._getStoryUrl,type:"POST",dataType:"json",data:A,beforeSend:function(){$U.showProgress("Wczytywanie artykułu...")},success:function(C){$U.hideProgress();$U.disableInputs("#frmStoryUpdate",false);if(C.errorMessage){$U.messageBox("Błąd",C.errorMessage,true)}else{$U.blockUI();var D=$("#storyEditorBox");$("span.error").hide();$("span.message").hide();$("#hidStoryId").val(C.id);$("#txtStoryName").val(C.name);$("#txtStoryCreatedAt").val(C.createdAt);$("#txtStoryTitle").val(C.title);$("#txtStoryDescription").val(C.description);$("#txtStoryTags").val(C.tags);$("#frmStoryUpdate input:radio").each(function(){var E=$(this)[0];if(E.value==C.category){E.checked=true}});$U.center(D);D.fadeIn();Moderation._centerMe()}}})},approveStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._approveStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Zatwierdzanie artykułu...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Błąd",D.errorMessage,true)}}})}$U.confirm("Zatwierdzić artykuł?","Jesteś pewny, że chcesz zatwierdzić ten artykuł?",A)},deleteStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._deleteStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Usuwanie artykułu...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Błąd",D.errorMessage,true)}}})}$U.confirm("Usunąć artykuł?","Jesteś pewny, że chcesz usunąć ten artykuł?",A)},confirmSpamStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._spamStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Zatwierdzanie spam artykułu...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Błąd",D.errorMessage,true)}}})}$U.confirm("Zatwierdzić spam artykuł?","Jesteś pewiny, że chcesz zatwierdzić ten artykuł jako spam?",A)},confirmSpamComment:function(C,A){function B(){var D={storyId:C,commentId:A};$.ajax({url:Moderation._spamCommentUrl,type:"POST",dataType:"json",data:D,beforeSend:function(){$U.showProgress("Zatwierdzania komentarza jako spam...")},success:function(E){$U.hideProgress();if(E.isSuccessful){$("#li-"+A).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Błąd",E.errorMessage,true)}}})}$U.confirm("Zatwierdzić komentarz jako spam?","Jesteś pewny, że chcesz zatwierdzić ten komentarz jako spam?",B)},markCommentAsOffended:function(C,A){function B(){var D={storyId:C,commentId:A};$.ajax({url:Moderation._markCommentAsOffendedUrl,type:"POST",dataType:"json",data:D,beforeSend:function(){$U.showProgress("Zaznaczanie jako obraźliwy...")},success:function(E){$U.hideProgress();if(E.isSuccessful){$U.messageBox("Sukces","Komentarz został oznaczony jako obraźliwy.",false)}else{$U.messageBox("Błąd",E.errorMessage,true)}}})}$U.confirm("Obraźliwy?","Jesteś pewien, że chcesz oznaczyć ten komentarz jako obraźliwy?",B)},_hide:function(){$U.disableInputs("#storyEditorBox",false);$U.hideProgress();Moderation._clearCenterMeTimer();$("#storyEditorBox").fadeOut("normal",function(){$U.unblockUI()})},_centerMe:function(){var A=$("#storyEditorBox");$U.center(A);Moderation._clearCenterMeTimer();Moderation._centerMeTimer=setInterval(function(){Moderation._centerMe()},2000)},_clearCenterMeTimer:function(){if(Moderation._centerMeTimer!=null){clearInterval(Moderation._centerMeTimer);Moderation._centerMeTimer=null}}};